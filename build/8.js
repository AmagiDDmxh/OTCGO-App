webpackJsonp([8],{1005:function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),e.d(n,"LoginPageModule",function(){return c});var i=e(0),o=e(1247),s=e(55),r=e(100),a=this&&this.__decorate||function(t,n,e,i){var o,s=arguments.length,r=s<3?n:null===i?i=Object.getOwnPropertyDescriptor(n,e):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,n,e,i);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(r=(s<3?o(r):s>3?o(n,e,r):o(n,e))||r);return s>3&&r&&Object.defineProperty(n,e,r),r},l=[o.a],c=function(){function t(){}return t=a([Object(i.I)({declarations:l,imports:[r.b.forChild(),s.f.forChild(o.a)]})],t)}()},1247:function(t,n,e){"use strict";e.d(n,"a",function(){return b});var i=e(0),o=e(36),s=e(15),r=e(100),a=e(55),l=e(16),c=(e.n(l),e(42)),p=e(1248),f=e(102),u=e(141),h=e(101),d=e(1249),g=this&&this.__decorate||function(t,n,e,i){var o,s=arguments.length,r=s<3?n:null===i?i=Object.getOwnPropertyDescriptor(n,e):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,n,e,i);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(r=(s<3?o(r):s>3?o(n,e,r):o(n,e))||r);return s>3&&r&&Object.defineProperty(n,e,r),r},m=this&&this.__metadata||function(t,n){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,n)},b=function(){function t(t,n,e,i,o,s,r,a){this.navCtrl=t,this.navParams=n,this.alertCtrl=e,this.fb=i,this.np=o,this.lp=s,this.ts=r,this.store=a,this.isWIFKey=!0,this.isOldWallet=!1,this.translationPrefix="LOGIN.",this.onDestroy=new l.Subject}return Object.defineProperty(t.prototype,"wif",{get:function(){return this.loginForm.get("wif")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"passphrase",{get:function(){return this.loginForm.get("passphrase")},enumerable:!0,configurable:!0}),t.prototype.ngOnInit=function(){this.buildForm(),this.subscribe(),this.getTranslations()},t.prototype.ngOnDestroy=function(){this.onDestroy.next()},t.prototype.getTranslations=function(){var t=this,n=["import_long","import_short"].map(function(n){return t.translationPrefix+n});this.ts.get(n).subscribe(function(e){t.importTextLong=e[n[0]],t.importTextShort=e[n[1]]}),this.importText=this.importTextShort},t.prototype.buildForm=function(){this.loginForm=this.fb.group({wif:["",[o.f.required],[d.a]],passphrase:["",[o.f.required,o.f.minLength(4)]]})},t.prototype.subscribe=function(){var t=this;this.store.select(h.a.getError).subscribe(function(n){return n&&t.np.emit({message:n})}),this.store.select(h.a.getLoading).subscribe(function(n){return n&&t.lp.emit(n)})},t.prototype.switchImportBox=function(t){this.isWIFKey=!1,this.importText=this.importTextLong,window.navigator&&!this.wif.value&&t.click()},t.prototype.switchWIFKeyBox=function(){this.isWIFKey=!0,this.importText=this.importTextShort},t.prototype.fileChange=function(t){if(/.json$/.test(t.name)){this.importText=t.name.slice();var n=new FileReader,e=this;n.onload=function(){try{var t=JSON.parse(this.result);if(Object(f.g)(t))return e.file=t,void(e.isOldWallet=!0);if(Object(f.i)(t))return e.file=t,void(e.isOldWallet=!1)}catch(t){console.log("file change error",t),e.showPrompt(t)}},n.readAsText(t)}},t.prototype.showPrompt=function(t){this.alertCtrl.create({title:t}).present()},t.prototype.login=function(t){var n=t.controls,e=t.value,i=n.wif,o=n.passphrase,s=e.wif,r=e.passphrase;if(this.file&&!this.isOldWallet&&(i.setValue(""),o.setValue("")),"test"===s)this.store.dispatch(new u.a.Login(p.a));else{if(s&&this.isWIFKey&&!r){if(i.invalid)return;return this.store.dispatch(new u.a.LoginWif(s))}if(this.file&&!this.isWIFKey&&!s){if(Object(f.g)(this.file)){if(!o.valid)return;return this.store.dispatch(new u.a.LoginOldWallet({oldWallet:this.file,passphrase:r}))}if(Object(f.i)(this.file))return this.store.dispatch(new u.a.Login(this.file))}}},t=g([Object(i.m)({selector:"page-login",template:'<ion-content class="login">\n\n\n\n\t<div class="login__container">\n\n\t\t<ion-label class="login__title">\n\n\t\t\t<h2>{{ \'LOGIN.title\' | translate }}</h2>\n\n\t\t</ion-label>\n\n\n\n\t\t<form [formGroup]="loginForm" (submit)="login(loginForm)">\n\n\t\t\t<ion-label class="login__error">\n\n\t\t\t\t<h5 *ngIf="wif.invalid && (wif.dirty || wif.touched) && wif.errors.invalidWIF">Invalid WIF format</h5>\n\n\t\t\t</ion-label>\n\n\n\n\t\t\t<ion-row class="login__wif-section">\n\n\t\t\t\t<ion-col>\n\n\t\t\t\t\t<ion-item class="login__wif-input rounded">\n\n\t\t\t\t\t\t<ion-input type="text" placeholder="{{ \'LOGIN.wif_placeholder\' | translate }}" formControlName="wif"></ion-input>\n\n\t\t\t\t\t</ion-item>\n\n\n\n\t\t\t\t\t<button\n\n\t\t\t\t\t  class="login__import-button"\n\n\t\t\t\t\t  type="button"\n\n\t\t\t\t\t  [class.is-active]="!isWIFKey"\n\n\t\t\t\t\t  (click)="switchImportBox(fileInput)">\n\n\t\t\t\t\t\t<span *ngIf="!isWIFKey">{{ importText }}</span>\n\n\t\t\t\t\t\t<img src="assets/imgs/icon-login_file.svg" alt="" class="icon">\n\n\t\t\t\t\t</button>\n\n\n\n\t\t\t\t\t<input accept="application/json, text/plain, .json" type="file" id="fileInput" hidden #fileInput (change)="fileChange(fileInput.files[0])">\n\n\n\n\t\t\t\t\t<button\n\n\t\t\t\t\t\tclass="login__wif-switcher"\n\n\t\t\t\t\t\ttype="button"\n\n\t\t\t\t\t\t*ngIf="!isWIFKey"\n\n\t\t\t\t\t\t(click)="switchWIFKeyBox()">\n\n\t\t\t\t\t\t<img src="assets/imgs/icon-login_WIF.svg" alt="" class="icon">\n\n\t\t\t\t\t</button>\n\n\t\t\t\t</ion-col>\n\n\t\t\t</ion-row>\n\n\n\n\t\t\t<ion-row class="login__password-section" *ngIf="isOldWallet">\n\n\t\t\t\t<ion-col>\n\n\t\t\t\t\t<ion-item class="login__password-input">\n\n\t\t\t\t\t\t<ion-input type="password" placeholder="{{ \'LOGIN.password\' | translate }}" formControlName="passphrase" required></ion-input>\n\n\t\t\t\t\t</ion-item>\n\n\t\t\t\t</ion-col>\n\n\t\t\t</ion-row>\n\n\n\n\t\t\t<ion-row>\n\n\t\t\t\t<ion-col>\n\n\t\t\t\t\t<button\n\n\t\t\t\t\t  ion-button round block outline\n\n\t\t\t\t\t  [disabled]="loginForm.valid"\n\n\t\t\t\t\t  class="login__button"\n\n\t\t\t\t\t  type="submit">{{ \'LOGIN.login_wallet\' | translate }}</button>\n\n\t\t\t\t</ion-col>\n\n\t\t\t</ion-row>\n\n\t\t</form>\n\n\n\n\t\t<div class="login__tip">\n\n\t\t\t<a (click)="navCtrl.setRoot(\'CreateWallet\')">{{ \'LOGIN.tip\' | translate }}</a>\n\n\t\t</div>\n\n\t</div>\n\n\n\n</ion-content>\n\n'}),m("design:paramtypes",[a.i,a.j,a.a,o.a,c.f,c.e,r.c,s.h])],t)}()},1248:function(t,n,e){"use strict";e.d(n,"a",function(){return i});var i={name:"userWallet",version:"1.0",scrypt:{cost:16384,blockSize:8,parallel:8,size:64},accounts:[{address:"AWqp5iP81A8boBcheWFQgLqnks4wkPkmRg",label:"1",isDefault:!1,lock:!1,key:"6PYLnNeafXYEt3jnv9Z7oLa3obcTM3BLqt13MBBzk25yo613WQ3pnBD93B",contract:{},extra:null},{address:"AXoibWhJXYRxckemGa8ZydGpQdBP7GX7st",label:"1234",isDefault:!0,lock:!1,key:"6PYU48pchs8osmxzHoKFX4Ka16SyutmvzkdH1ptjhJymPxJ39nx6qfBs8x",contract:{},extra:null}],extra:{contacts:[{name:"John",address:"AHZDq78w1ERcDYVBWjU5owWcbFZKLvhg7X",description:"Work friend"},{name:"Joe",address:"AXoibWhJXYRxckemGa8ZydGpQdBP7GX7st",description:"Special friend"},{name:"Tom",address:"AJnNUn6HynVcco1p8LER72s4zXtNFYDnys"},{name:"张三",address:"ANsvyS9q1n6SBDVSdB6uFwVeqT512YSAoW",description:"我的中国朋友"}]}}},1249:function(t,n,e){"use strict";n.a=function(t){return i.Observable.create(function(n){return t.valueChanges.pipe(Object(o.debounceTime)(400),Object(o.map)(function(t){return t.trim()}),Object(o.map)(function(t){if(t&&Object(s.h)(t))return null;throw new Error("invalidWIF")})).subscribe(function(t){return n.next(null)},function(t){n.next((e={},e[t.message]=!0,e)),n.complete();var e})})};var i=e(8),o=(e.n(i),e(37)),s=(e.n(o),e(102))}});